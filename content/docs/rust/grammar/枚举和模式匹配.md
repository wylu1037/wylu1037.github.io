---
title: æšä¸¾å’Œæ¨¡å¼åŒ¹é…
date: 2024-03-11T19:50:20+08:00
authors:
  - name: wylu
    link: https://github.com/wylu1037
    image: https://github.com/wylu1037.png?size=40
weight: 4
---

## 1.æšä¸¾
### 1.1 å®šä¹‰æšä¸¾
```rust
fn main() {
    enum Message {
        Quit, // æ²¡æœ‰å…³è”ä»»ä½•æ•°æ®
        Move { x: i32, y: i32 }, // åŒ…å«ä¸€ä¸ªåŒ¿åç»“æ„ä½“
        Write(String), // åŒ…å«å•ç‹¬ä¸€ä¸ª String
        ChangeColor(i32, i32, i32), // åŒ…å«ä¸‰ä¸ª i32
    }
}
```

ä½¿ç”¨structå®šä¹‰ğŸ‘†æšä¸¾ä¸­çš„æˆå‘˜
```rust
fn main() {
    struct QuitMessage; // ç±»å•å…ƒç»“æ„ä½“
    struct MoveMessage {
        x: i32,
        y: i32,
    }
    struct WriteMessage(String); // å…ƒç»„ç»“æ„ä½“
    struct ChangeColorMessage(i32, i32, i32); // å…ƒç»„ç»“æ„ä½“
}
```

### 1.2 ä¸ºæšä¸¾å®šä¹‰æ–¹æ³•
```rust
fn main() {
    enum Message {
        Quit,
        Move { x: i32, y: i32 },
        Write(String),
        ChangeColor(i32, i32, i32),
    }
    
    impl Message {
        fn call(&self) {
            // åœ¨è¿™é‡Œå®šä¹‰æ–¹æ³•ä½“
        }
    }
    
    let m = Message::Write(String::from("hello"));
    m.call();
}
```

### 1.3 Option
å®šä¹‰åœ¨æ ‡å‡†åº“å¦‚ä¸‹ï¼š
```rust
enum Option<T> {
    Some(T),
    None,
}
```

ä½¿ç”¨Option
```rust
fn main() {
    let some_number = Some(5);
    let some_string = Some("a string");
    
    let absent_number: Option<i32> = None;
}
```


## 2.match æ§åˆ¶æµ
```rust
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}
```

### 2.1 ç»‘å®šå€¼çš„æ¨¡å¼
åŒ¹é…åˆ†æ”¯çš„å¦ä¸€ä¸ªåŠŸèƒ½æ˜¯å¯ä»¥ç»‘å®šåŒ¹é…æ¨¡å¼çš„éƒ¨åˆ†å€¼ï¼Œå³ä»æšä¸¾æˆå‘˜ä¸­æå–å€¼ã€‚
```rust
#[derive(Debug)] // è¿™æ ·å¯ä»¥ç«‹åˆ»çœ‹åˆ°å·çš„åç§°
enum UsState {
    Alabama,
    Alaska,
    // --snip--
}

enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter(UsState),
}

fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter(state) => {
            println!("State quarter from {:?}!", state);
            25
        }
    }
}
```

### 2.2 åŒ¹é…`Option<T>`
```rust
fn main() {
    fn plus_one(x: Option<i32>) -> Option<i32> {
        match x {
            None => None,
            Some(i) => Some(i + 1),
        }
    }

    let five = Some(5);
    let six = plus_one(five);
    let none = plus_one(None);
}
```

### 2.3 âš ï¸ åŒ¹é…æ˜¯ç©·å°½çš„
```rust
fn plus_one(x: Option<i32>) -> Option<i32> {
    match x { // error[E0004]: non-exhaustive patterns: `None` not covered
        Some(i) => Some(i + 1),
    }
}
```
æ²¡æœ‰å¤„ç†`None`çš„æƒ…å†µï¼Œä¼šé€ æˆ`bug`ã€‚

### 2.4 é€šé…æ¨¡å¼å’Œ`_`å ä½ç¬¦
å¯¹ä¸€äº›ç‰¹å®šçš„å€¼é‡‡å–ç‰¹æ®Šæ“ä½œï¼Œè€Œå¯¹å…¶å®ƒå€¼é‡‡å–é»˜è®¤æ“ä½œã€‚
```rust
fn main() {
    let dice_roll = 9;
    match dice_roll {
        3 => add_fancy_hat(),
        7 => remove_fancy_hat(),
        other => move_player(other),
    }

    fn add_fancy_hat() {}
    fn remove_fancy_hat() {}
    fn move_player(num_spaces: u8) {}
}
```
å½“ä¸æƒ³ä½¿ç”¨é€šé…æ¨¡å¼è·å–å€¼æ—¶ï¼Œä½¿ç”¨`_`ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å€¼è€Œä¸ç»‘å®šåˆ°è¯¥å€¼ï¼Œå‘Šè¯‰`Rust`ä¸ä¼šä½¿ç”¨è¿™ä¸ªå€¼ã€‚
```rust
fn main() {
    let dice_roll = 9;
    match dice_roll {
        3 => add_fancy_hat(),
        7 => remove_fancy_hat(),
        _ => (), // ä¸ä¼šä½¿ç”¨ä¸å‰é¢æ¨¡å¼ä¸åŒ¹é…çš„å€¼ï¼Œå¹¶ä¸”ä¸æƒ³è¿è¡Œä»»ä½•ä»£ç ã€‚
    }

    fn add_fancy_hat() {}
    fn remove_fancy_hat() {}
}
```

## 3.if let æ§åˆ¶æµ
å¤„ç†åŒ¹é…ä¸€ä¸ªæ¨¡å¼çš„å€¼è€Œå¿½ç•¥å…¶å®ƒæ¨¡å¼çš„æƒ…å†µã€‚
```rust
fn main() {
    let some_u8_value = Some(0u8);
    match some_u8_value {
        Some(3) => println!("three"),
        _ => (),
    }
}
```
ä¿®æ”¹ä¸º
```rust
fn main() {
    let some_u8_value = Some(0u8);
    if let Some(3) = some_u8_value {
        println!("three");
    }
}
```
å¯ä»¥è®¤ä¸º`if let`æ˜¯`match`çš„ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå®ƒå½“å€¼åŒ¹é…æŸä¸€æ¨¡å¼æ—¶æ‰§è¡Œä»£ç è€Œå¿½ç•¥æ‰€æœ‰å…¶ä»–å€¼ã€‚

å¯ä»¥åœ¨`if let`ä¸­åŒ…å«ä¸€ä¸ª`else`ã€‚`else`å—ä¸­çš„ä»£ç ä¸`match`è¡¨è¾¾å¼ä¸­çš„`_`åˆ†æ”¯å—ä¸­çš„ä»£ç ç›¸åŒï¼Œè¿™æ ·çš„`match`è¡¨è¾¾å¼å°±ç­‰åŒäº`if let`å’Œ`else`ã€‚
```rust
fn main() {
    let mut count = 0;
    if let Coin::Quarter(state) = coin {
        println!("State quarter from {:?}!", state);
    } else {
        count += 1;
    }
}
```
